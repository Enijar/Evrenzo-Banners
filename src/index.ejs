<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta
            name="viewport"
            content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Ad Banners</title>
</head>
<body>
<div class="container container-<%= type %>">
    <main id="carousel" data-slide-index="0"
          style="background-image: url('<%= require('./config').backgroundImage %>')">
        <% require('./config').slides.forEach((slide, index) => { %>
            <section data-slide-index="<%= index %>" data-timeout="<%= slide.timeout %>"
                     style="background-color: <%= slide.backgroundColor %>;">
                <%= slide.content %>
                <div class="disclaimer"><%= require('./config').hcpDisclaimer %></div>
            </section>
        <% }) %>
    </main>
    <aside>
        <img src="<%= require('./config').content.logos.evrenzo %>" alt="Evrenzo roxadustat"/>
        <small><%= require('./config').jobCode %></small>
    </aside>
</div>
<script>
  window.mode = "<%= mode %>";
</script>
<script>
  window.addEventListener("load", () => {
    const carousel = document.querySelector("#carousel");
    const slides = carousel.querySelectorAll("section");

    const externalState = window.state || {}

    const state = {
      autoPlay: window.mode === "production" ? true : true,
      loop: window.mode === "production" ? false : false,
      slideIndex: window.mode === "production" ? -1 : -1,
      ...externalState,
    };

    function nextSlide () {
      state.slideIndex++;
      if (!slides[state.slideIndex]) {
        if (!state.loop) return;
        state.slideIndex = 0;
      }
      carousel.style.setProperty("--slide-index", state.slideIndex);
      carousel.dataset.slideIndex = state.slideIndex;
      slides.forEach(slide => {
        slide.style.opacity = "0";
      })
      slides[state.slideIndex].style.opacity = "1";
      if (!state.autoPlay) return;
      setTimeout(nextSlide, parseInt(slides[state.slideIndex].dataset.timeout));
    }

    window.nextSlide = nextSlide;

    nextSlide()
  })
</script>
</body>
</html>
